<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <meta
      name="keywords"
      content="microfrontend, micro frontend, micro frontends, micro-frontend, micro-frontends, microservice, javascript"
    />
    <link rel="stylesheet" href="/qiankun/umi.e86c697b.css" />
    <script>
      window.routerBase = "/qiankun";
    </script>
    <script>
      //! umi version: 3.2.14
    </script>
    <script>
      var _hmt = _hmt || [];
    </script>
    <script>
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?0f738d9b0ac90574c09183ea85bcfa2e";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <title>API &#x8BF4;&#x660E;</title>
  </head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="false" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:" data-plaintext="true" href="/qiankun/zh">qiankun</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/qiankun/zh/guide">æŒ‡å—</a><a aria-current="page" class="active" href="/qiankun/zh/api">API</a><a href="/qiankun/zh/faq">å¸¸è§é—®é¢˜</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/qiankun/releases">å‘å¸ƒæ—¥å¿—<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a target="_blank" rel="noopener noreferrer" href="https://v1.qiankun.umijs.org/zh/">1.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/qiankun">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><div class="__dumi-default-locale-select" data-locale-count="2"><span>English</span></div></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:" href="/qiankun/zh"></a><h1>qiankun</h1><p></p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/qiankun/zh/guide">æŒ‡å—</a></li><li><a aria-current="page" class="active" href="/qiankun/zh/api">API</a></li><li><a href="/qiankun/zh/faq">å¸¸è§é—®é¢˜</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/qiankun/releases">å‘å¸ƒæ—¥å¿—<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://v1.qiankun.umijs.org/zh/">1.x<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/umijs/qiankun">GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><div class="__dumi-default-locale-select" data-locale-count="2"><span>English</span></div></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/qiankun/zh/api">API è¯´æ˜</a><ul role="slug-list"><li title="åŸºäºè·¯ç”±é…ç½®" data-depth="2" class=""><a href="/qiankun/zh/api#åŸºäºè·¯ç”±é…ç½®"><span>åŸºäºè·¯ç”±é…ç½®</span></a></li><li title="registerMicroApps(apps, lifeCycles?)" data-depth="3" class=""><a href="/qiankun/zh/api#registermicroappsapps-lifecycles"><span>registerMicroApps(apps, lifeCycles?)</span></a></li><li title="start(opts?)" data-depth="3" class=""><a href="/qiankun/zh/api#startopts"><span>start(opts?)</span></a></li><li title="setDefaultMountApp(appLink)`" data-depth="3" class=""><a href="/qiankun/zh/api#setdefaultmountappapplink"><span>setDefaultMountApp(appLink)`</span></a></li><li title="runAfterFirstMounted(effect)" data-depth="3" class=""><a href="/qiankun/zh/api#runafterfirstmountedeffect"><span>runAfterFirstMounted(effect)</span></a></li><li title="æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨" data-depth="2" class=""><a href="/qiankun/zh/api#æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨"><span>æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨</span></a></li><li title="loadMicroApp(app, configuration?)" data-depth="3" class=""><a href="/qiankun/zh/api#loadmicroappapp-configuration"><span>loadMicroApp(app, configuration?)</span></a></li><li title="prefetchApps(apps, importEntryOpts?)" data-depth="3" class=""><a href="/qiankun/zh/api#prefetchappsapps-importentryopts"><span>prefetchApps(apps, importEntryOpts?)</span></a></li><li title="addErrorHandler/removeErrorHandler" data-depth="2" class=""><a href="/qiankun/zh/api#adderrorhandlerremoveerrorhandler"><span>addErrorHandler/removeErrorHandler</span></a></li><li title="addGlobalUncaughtErrorHandler(handler)" data-depth="2" class=""><a href="/qiankun/zh/api#addglobaluncaughterrorhandlerhandler"><span>addGlobalUncaughtErrorHandler(handler)</span></a></li><li title="removeGlobalUncaughtErrorHandler(handler)" data-depth="2" class=""><a href="/qiankun/zh/api#removeglobaluncaughterrorhandlerhandler"><span>removeGlobalUncaughtErrorHandler(handler)</span></a></li><li title="initGlobalState(state)" data-depth="2" class=""><a href="/qiankun/zh/api#initglobalstatestate"><span>initGlobalState(state)</span></a></li></ul></li></ul></div></div><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="api-è¯´æ˜"><a aria-hidden="true" href="#api-è¯´æ˜"><span class="icon icon-link"></span></a>API è¯´æ˜</h1><h2 id="åŸºäºè·¯ç”±é…ç½®"><a aria-hidden="true" href="#åŸºäºè·¯ç”±é…ç½®"><span class="icon icon-link"></span></a>åŸºäºè·¯ç”±é…ç½®</h2><p>é€‚ç”¨äº route-based åœºæ™¯ã€‚</p><p>é€šè¿‡å°†å¾®åº”ç”¨å…³è”åˆ°ä¸€äº› url è§„åˆ™çš„æ–¹å¼ï¼Œå®ç°å½“æµè§ˆå™¨ url å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè‡ªåŠ¨åŠ è½½ç›¸åº”çš„å¾®åº”ç”¨çš„åŠŸèƒ½ã€‚</p><h3 id="registermicroappsapps-lifecycles"><a aria-hidden="true" href="#registermicroappsapps-lifecycles"><span class="icon icon-link"></span></a>registerMicroApps(apps, lifeCycles?)</h3><ul><li><p>å‚æ•°</p><ul><li>apps - <code>Array&lt;RegistrableApp&gt;</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„ä¸€äº›æ³¨å†Œä¿¡æ¯</li><li>lifeCycles - <code>LifeCycles</code> - å¯é€‰ï¼Œå…¨å±€çš„å¾®åº”ç”¨ç”Ÿå‘½å‘¨æœŸé’©å­</li></ul></li><li><p>ç±»å‹</p><ul><li><p><code>RegistrableApp</code></p><ul><li><p>name - <code>string</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„åç§°ï¼Œå¾®åº”ç”¨ä¹‹é—´å¿…é¡»ç¡®ä¿å”¯ä¸€ã€‚</p></li><li><p>entry - <code>string | <!-- -->{<!-- --> scripts?: string[]; styles?: string[]; html?: string <!-- -->}</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„ entry åœ°å€ã€‚</p></li><li><p>container - <code>string | HTMLElement</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„å®¹å™¨èŠ‚ç‚¹çš„é€‰æ‹©å™¨æˆ–è€… Element å®ä¾‹ã€‚å¦‚<code>container: &#x27;#root&#x27;</code> æˆ– <code>container: document.querySelector(&#x27;#root&#x27;)</code>ã€‚</p></li><li><p>activeRule - <code>string | (location: Location) =&gt; boolean | Array&lt;string | (location: Location) =&gt; boolean&gt; </code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„æ¿€æ´»è§„åˆ™ã€‚</p><ul><li>æ”¯æŒç›´æ¥é…ç½®å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ï¼Œå¦‚ <code>activeRule: &#x27;/app1&#x27;</code> æˆ– <code>activeRule: [&#x27;/app1&#x27;, &#x27;/app2&#x27;]</code>ï¼Œå½“é…ç½®ä¸ºå­—ç¬¦ä¸²æ—¶ä¼šç›´æ¥è·Ÿ url ä¸­çš„è·¯å¾„éƒ¨åˆ†åšå‰ç¼€åŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸè¡¨æ˜å½“å‰åº”ç”¨ä¼šè¢«æ¿€æ´»ã€‚</li><li>æ”¯æŒé…ç½®ä¸€ä¸ª active function å‡½æ•°æˆ–ä¸€ç»„ active functionã€‚å‡½æ•°ä¼šä¼ å…¥å½“å‰ location ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°è¿”å› true æ—¶è¡¨æ˜å½“å‰å¾®åº”ç”¨ä¼šè¢«æ¿€æ´»ã€‚å¦‚ <code>location =&gt; location.pathname.startsWith(&#x27;/app1&#x27;)</code>ã€‚</li></ul><p>è§„åˆ™ç¤ºä¾‹ï¼š</p><p><code>&#x27;/app1&#x27;</code></p><ul><li><p>âœ… <a href="https://app.com/app1" target="_blank" rel="noopener noreferrer">https://app.com/app1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p>âœ… <a href="https://app.com/app1/anything/everything" target="_blank" rel="noopener noreferrer">https://app.com/app1/anything/everything<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p>ğŸš« <a href="https://app.com/app2" target="_blank" rel="noopener noreferrer">https://app.com/app2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul><p><code>&#x27;/users/:userId/profile&#x27;</code></p><ul><li>âœ… <a href="https://app.com/users/123/profile" target="_blank" rel="noopener noreferrer">https://app.com/users/123/profile<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>âœ… <a href="https://app.com/users/123/profile/sub-profile/" target="_blank" rel="noopener noreferrer">https://app.com/users/123/profile/sub-profile/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>ğŸš« <a href="https://app.com/users//profile/sub-profile/" target="_blank" rel="noopener noreferrer">https://app.com/users//profile/sub-profile/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>ğŸš« <a href="https://app.com/users/profile/sub-profile/" target="_blank" rel="noopener noreferrer">https://app.com/users/profile/sub-profile/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p><code>&#x27;/pathname/#/hash&#x27;</code></p><ul><li>âœ… <a href="https://app.com/pathname/#/hash" target="_blank" rel="noopener noreferrer">https://app.com/pathname/#/hash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>âœ… <a href="https://app.com/pathname/#/hash/route/nested" target="_blank" rel="noopener noreferrer">https://app.com/pathname/#/hash/route/nested<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>ğŸš« <a href="https://app.com/pathname#/hash/route/nested" target="_blank" rel="noopener noreferrer">https://app.com/pathname#/hash/route/nested<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>ğŸš« <a href="https://app.com/pathname#/another-hash" target="_blank" rel="noopener noreferrer">https://app.com/pathname#/another-hash<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p><code>[&#x27;/pathname/#/hash&#x27;, &#x27;/app1&#x27;]</code></p><ul><li>âœ… <a href="https://app.com/pathname/#/hash/route/nested" target="_blank" rel="noopener noreferrer">https://app.com/pathname/#/hash/route/nested<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>âœ… <a href="https://app.com/app1/anything/everything" target="_blank" rel="noopener noreferrer">https://app.com/app1/anything/everything<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>ğŸš« <a href="https://app.com/pathname/app1" target="_blank" rel="noopener noreferrer">https://app.com/pathname/app1<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li>ğŸš« <a href="https://app.com/app2" target="_blank" rel="noopener noreferrer">https://app.com/app2<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><p>æµè§ˆå™¨ url å‘ç”Ÿå˜åŒ–ä¼šè°ƒç”¨ activeRule é‡Œçš„è§„åˆ™ï¼Œ<code>activeRule</code> ä»»æ„ä¸€ä¸ªè¿”å› <code>true</code> æ—¶è¡¨æ˜è¯¥å¾®åº”ç”¨éœ€è¦è¢«æ¿€æ´»ã€‚</p></li><li><p>loader - <code>(loading: boolean) =&gt; void</code> - å¯é€‰ï¼Œloading çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ä¼šè°ƒç”¨çš„æ–¹æ³•ã€‚</p></li><li><p>props - <code>object</code> - å¯é€‰ï¼Œä¸»åº”ç”¨éœ€è¦ä¼ é€’ç»™å¾®åº”ç”¨çš„æ•°æ®ã€‚</p></li></ul></li><li><p><code>LifeCycles</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="type Lifecycle = (app: RegistrableApp) =&gt; Promise&lt;any&gt;;
" data-status="copy"></button><div class="token-line"><span class="token keyword">type</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name">Lifecycle</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">app</span><span class="token parameter punctuation">:</span><span class="token parameter"> RegistrableApp</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token known-class-name class-name">Promise</span><span class="token operator">&lt;</span><span class="token builtin">any</span><span class="token operator">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li>beforeLoad - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - å¯é€‰</li><li>beforeMount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - å¯é€‰</li><li>afterMount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - å¯é€‰</li><li>beforeUnmount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - å¯é€‰</li><li>afterUnmount - <code>Lifecycle | Array&lt;Lifecycle&gt;</code> - å¯é€‰</li></ul></li></ul></li><li><p>ç”¨æ³•</p><p>æ³¨å†Œå¾®åº”ç”¨çš„åŸºç¡€é…ç½®ä¿¡æ¯ã€‚å½“æµè§ˆå™¨ url å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ£€æŸ¥æ¯ä¸€ä¸ªå¾®åº”ç”¨æ³¨å†Œçš„ <code>activeRule</code> è§„åˆ™ï¼Œç¬¦åˆè§„åˆ™çš„åº”ç”¨å°†ä¼šè¢«è‡ªåŠ¨æ¿€æ´»ã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-tsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { registerMicroApps } from &#x27;qiankun&#x27;;

registerMicroApps(
  [
    {
      name: &#x27;app1&#x27;,
      entry: &#x27;//localhost:8080&#x27;,
      container: &#x27;#container&#x27;,
      activeRule: &#x27;/react&#x27;,
      props: {
        name: &#x27;kuitos&#x27;,
      }
    }
  ],
  {
    beforeLoad: app =&gt; console.log(&#x27;before load&#x27;, app.name),
    beforeMount: [
      app =&gt; console.log(&#x27;before mount&#x27;, app.name),
    ],
  },
);
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> registerMicroApps </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">registerMicroApps</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      entry</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;//localhost:8080&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      container</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;#container&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      activeRule</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;/react&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      props</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;kuitos&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function-variable function">beforeLoad</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token parameter">app</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;before load&#x27;</span><span class="token punctuation">,</span><span class="token plain"> app</span><span class="token punctuation">.</span><span class="token plain">name</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    beforeMount</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token parameter">app</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#x27;before mount&#x27;</span><span class="token punctuation">,</span><span class="token plain"> app</span><span class="token punctuation">.</span><span class="token plain">name</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h3 id="startopts"><a aria-hidden="true" href="#startopts"><span class="icon icon-link"></span></a><code>start(opts?)</code></h3><ul><li><p>å‚æ•°</p><ul><li>opts - <code>Options</code> å¯é€‰</li></ul></li><li><p>ç±»å‹</p><ul><li><p><code>Options</code></p><ul><li><p>prefetch - <code>boolean | &#x27;all&#x27; | string[] | (( apps: RegistrableApp[] ) =&gt; <!-- -->{<!-- --> criticalAppNames: string[]; minorAppsName: string[] <!-- -->}<!-- -->)</code> - å¯é€‰ï¼Œæ˜¯å¦å¼€å¯é¢„åŠ è½½ï¼Œé»˜è®¤ä¸º <code>true</code>ã€‚</p><p>é…ç½®ä¸º <code>true</code> åˆ™ä¼šåœ¨ç¬¬ä¸€ä¸ªå¾®åº”ç”¨ mount å®Œæˆåå¼€å§‹é¢„åŠ è½½å…¶ä»–å¾®åº”ç”¨çš„é™æ€èµ„æºï¼Œé…ç½®ä¸º <code>&#x27;all&#x27;</code> åˆ™ä¸»åº”ç”¨ <code>start</code> åå³å¼€å§‹é¢„åŠ è½½æ‰€æœ‰å¾®åº”ç”¨é™æ€èµ„æºã€‚</p><p>é…ç½®ä¸º <code>&#x27;all&#x27;</code> åˆ™ä¸»åº”ç”¨ <code>start</code> åå³å¼€å§‹é¢„åŠ è½½æ‰€æœ‰å¾®åº”ç”¨é™æ€èµ„æºã€‚</p><p>é…ç½®ä¸º <code>string[]</code> åˆ™ä¼šåœ¨ç¬¬ä¸€ä¸ªå¾®åº”ç”¨ mounted åå¼€å§‹åŠ è½½æ•°ç»„å†…çš„å¾®åº”ç”¨èµ„æº</p><p>é…ç½®ä¸º <code>function</code> åˆ™å¯å®Œå…¨è‡ªå®šä¹‰åº”ç”¨çš„èµ„æºåŠ è½½æ—¶æœº (é¦–å±åº”ç”¨åŠæ¬¡å±åº”ç”¨)</p></li><li><p>sandbox - <code>boolean</code> | <code>{<!-- --> strictStyleIsolation?: boolean, experimentalStyleIsolation?: boolean <!-- -->}</code> - å¯é€‰ï¼Œæ˜¯å¦å¼€å¯æ²™ç®±ï¼Œé»˜è®¤ä¸º <code>true</code>ã€‚</p><p>å½“é…ç½®ä¸º <code>{<!-- --> strictStyleIsolation: true <!-- -->}</code> è¡¨ç¤ºå¼€å¯ä¸¥æ ¼çš„æ ·å¼éš”ç¦»æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹ qiankun ä¼šä¸ºæ¯ä¸ªå¾®åº”ç”¨çš„å®¹å™¨åŒ…è£¹ä¸Šä¸€ä¸ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/Using_shadow_DOM" target="_blank" rel="noopener noreferrer">shadow dom<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> èŠ‚ç‚¹ï¼Œä»è€Œç¡®ä¿å¾®åº”ç”¨çš„æ ·å¼ä¸ä¼šå¯¹å…¨å±€é€ æˆå½±å“ã€‚</p><p>è€Œé™¤æ­¤ä»¥å¤–ï¼Œqiankun è¿˜æä¾›äº†ä¸€ç§å®éªŒæ€§çš„æ–¹å¼æ¥æ”¯æŒæ ·å¼éš”ç¦»ï¼Œå½“ <code>experimentalStyleIsolation</code> è¢«è®¾ç½®ä¸º true æ—¶ï¼Œqiankun å°†ä¼šé€šè¿‡åŠ¨æ€æ”¹å†™ä¸€ä¸ªç‰¹æ®Šçš„é€‰æ‹©å™¨çº¦æŸæ¥é™åˆ¶ css çš„ç”Ÿæ•ˆèŒƒå›´ï¼Œåº”ç”¨çš„æ ·å¼ä¼šæŒ‰ç…§å¦‚ä¸‹æ¨¡å¼æ”¹å†™ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-javascript"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// å‡è®¾åº”ç”¨åæ˜¯ react16
.app-main {
  font-size: 14px;
}

div[data-qiankun-react16] .app-main {
  font-size: 14px;
}
" data-status="copy"></button><div class="token-line"><span class="token comment">// å‡è®¾åº”ç”¨åæ˜¯ react16</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">.</span><span class="token property-access">app</span><span class="token operator">-</span><span class="token plain">main </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  font</span><span class="token operator">-</span><span class="token plain">size</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">px</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">div</span><span class="token punctuation">[</span><span class="token plain">data</span><span class="token operator">-</span><span class="token plain">qiankun</span><span class="token operator">-</span><span class="token plain">react16</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token punctuation">.</span><span class="token property-access">app</span><span class="token operator">-</span><span class="token plain">main </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  font</span><span class="token operator">-</span><span class="token plain">size</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token number">14</span><span class="token plain">px</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>æ³¨æ„: @keyframes, @font-face, @import, @page å°†ä¸è¢«æ”¯æŒ (i.e. ä¸ä¼šè¢«æ”¹å†™) P.S: åœ¨ç›®å‰çš„é˜¶æ®µï¼Œè¯¥åŠŸèƒ½è¿˜ä¸æ”¯æŒåŠ¨æ€çš„ã€ä½¿ç”¨ <code>&lt;link /&gt;</code>æ ‡ç­¾æ¥æ’å…¥å¤–è”çš„æ ·å¼ï¼Œä½†è€ƒè™‘åœ¨æœªæ¥æ”¯æŒè¿™éƒ¨åˆ†åœºæ™¯ã€‚</p></li><li><p>singular - <code>boolean | ((app: RegistrableApp&lt;any&gt;) =&gt; Promise&lt;boolean&gt;);</code> - å¯é€‰ï¼Œæ˜¯å¦ä¸ºå•å®ä¾‹åœºæ™¯ï¼Œå•å®ä¾‹æŒ‡çš„æ˜¯åŒä¸€æ—¶é—´åªä¼šæ¸²æŸ“ä¸€ä¸ªå¾®åº”ç”¨ã€‚é»˜è®¤ä¸º <code>true</code>ã€‚</p></li><li><p>fetch - <code>Function</code> - å¯é€‰ï¼Œè‡ªå®šä¹‰çš„ fetch æ–¹æ³•ã€‚</p></li><li><p>getPublicPath - <code>(url: string) =&gt; string</code> - å¯é€‰</p></li><li><p>getTemplate - <code>(tpl: string) =&gt; string</code> - å¯é€‰</p></li><li><p>excludeAssetFilter - <code>(assetUrl: string) =&gt; boolean</code> - å¯é€‰ï¼ŒæŒ‡å®šéƒ¨åˆ†ç‰¹æ®Šçš„åŠ¨æ€åŠ è½½çš„å¾®åº”ç”¨èµ„æºï¼ˆcss/js) ä¸è¢«qiankun åŠ«æŒå¤„ç†</p></li></ul></li></ul></li><li><p>ç”¨æ³•</p><p>å¯åŠ¨ qiankunã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { start } from &#x27;qiankun&#x27;;

start();
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> start </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h3 id="setdefaultmountappapplink"><a aria-hidden="true" href="#setdefaultmountappapplink"><span class="icon icon-link"></span></a>setDefaultMountApp(appLink)`</h3><ul><li><p>å‚æ•°</p><ul><li>appLink - <code>string</code> - å¿…é€‰</li></ul></li><li><p>ç”¨æ³•</p><p>è®¾ç½®ä¸»åº”ç”¨å¯åŠ¨åé»˜è®¤è¿›å…¥çš„å¾®åº”ç”¨ã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { setDefaultMountApp } from &#x27;qiankun&#x27;;

setDefaultMountApp(&#x27;/homeApp&#x27;);
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> setDefaultMountApp </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">setDefaultMountApp</span><span class="token punctuation">(</span><span class="token string">&#x27;/homeApp&#x27;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h3 id="runafterfirstmountedeffect"><a aria-hidden="true" href="#runafterfirstmountedeffect"><span class="icon icon-link"></span></a><code>runAfterFirstMounted(effect)</code></h3><ul><li><p>å‚æ•°</p><ul><li>effect - <code>() =&gt; void</code> - å¿…é€‰</li></ul></li><li><p>ç”¨æ³•</p><p>ç¬¬ä¸€ä¸ªå¾®åº”ç”¨ mount åéœ€è¦è°ƒç”¨çš„æ–¹æ³•ï¼Œæ¯”å¦‚å¼€å¯ä¸€äº›ç›‘æ§æˆ–è€…åŸ‹ç‚¹è„šæœ¬ã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { runAfterFirstMounted } from &#x27;qiankun&#x27;;

runAfterFirstMounted(() =&gt; startMonitor());
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> runAfterFirstMounted </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">runAfterFirstMounted</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token function">startMonitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h2 id="æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨"><a aria-hidden="true" href="#æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨"><span class="icon icon-link"></span></a>æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨</h2><p>é€‚ç”¨äºéœ€è¦æ‰‹åŠ¨ åŠ è½½/å¸è½½ ä¸€ä¸ªå¾®åº”ç”¨çš„åœºæ™¯ã€‚</p><div class="__dumi-default-alert" type="info">é€šå¸¸è¿™ç§åœºæ™¯ä¸‹å¾®åº”ç”¨æ˜¯ä¸€ä¸ªä¸å¸¦è·¯ç”±çš„å¯ç‹¬ç«‹è¿è¡Œçš„ä¸šåŠ¡ç»„ä»¶ã€‚ å¾®åº”ç”¨ä¸å®œæ‹†åˆ†è¿‡ç»†ï¼Œå»ºè®®æŒ‰ç…§ä¸šåŠ¡åŸŸæ¥åšæ‹†åˆ†ã€‚ä¸šåŠ¡å…³è”ç´§å¯†çš„åŠŸèƒ½å•å…ƒåº”è¯¥åšæˆä¸€ä¸ªå¾®åº”ç”¨ï¼Œåä¹‹å…³è”ä¸ç´§å¯†çš„å¯ä»¥è€ƒè™‘æ‹†åˆ†æˆå¤šä¸ªå¾®åº”ç”¨ã€‚ ä¸€ä¸ªåˆ¤æ–­ä¸šåŠ¡å…³è”æ˜¯å¦ç´§å¯†çš„æ ‡å‡†ï¼š<strong>çœ‹è¿™ä¸ªå¾®åº”ç”¨ä¸å…¶ä»–å¾®åº”ç”¨æ˜¯å¦æœ‰é¢‘ç¹çš„é€šä¿¡éœ€æ±‚</strong>ã€‚å¦‚æœæœ‰å¯èƒ½è¯´æ˜è¿™ä¸¤ä¸ªå¾®åº”ç”¨æœ¬èº«å°±æ˜¯æœåŠ¡äºåŒä¸€ä¸ªä¸šåŠ¡åœºæ™¯ï¼Œåˆå¹¶æˆä¸€ä¸ªå¾®åº”ç”¨å¯èƒ½ä¼šæ›´åˆé€‚ã€‚</div><h3 id="loadmicroappapp-configuration"><a aria-hidden="true" href="#loadmicroappapp-configuration"><span class="icon icon-link"></span></a><code>loadMicroApp(app, configuration?)</code></h3><ul><li><p>å‚æ•°</p><ul><li><p>app - <code>LoadableApp</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„åŸºç¡€ä¿¡æ¯</p><ul><li>name - <code>string</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„åç§°ï¼Œå¾®åº”ç”¨ä¹‹é—´å¿…é¡»ç¡®ä¿å”¯ä¸€ã€‚</li><li>entry - <code>string | <!-- -->{<!-- --> scripts?: string[]; styles?: string[]; html?: string <!-- -->}</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„ entry åœ°å€ã€‚</li><li>container - <code>string | HTMLElement</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„å®¹å™¨èŠ‚ç‚¹çš„é€‰æ‹©å™¨æˆ–è€… Element å®ä¾‹ã€‚å¦‚<code>container: &#x27;#root&#x27;</code> æˆ– <code>container: document.querySelector(&#x27;#root&#x27;)</code>ã€‚</li><li>props - <code>object</code> - å¯é€‰ï¼Œåˆå§‹åŒ–æ—¶éœ€è¦ä¼ é€’ç»™å¾®åº”ç”¨çš„æ•°æ®ã€‚</li></ul></li><li><p>configuration - <code>Configuration</code> - å¯é€‰ï¼Œå¾®åº”ç”¨çš„é…ç½®ä¿¡æ¯</p><ul><li><p>sandbox - <code>boolean</code> | <code>{<!-- --> strictStyleIsolation?: boolean, experimentalStyleIsolation?: boolean <!-- -->}</code> - å¯é€‰ï¼Œæ˜¯å¦å¼€å¯æ²™ç®±ï¼Œé»˜è®¤ä¸º <code>true</code>ã€‚</p><p>é»˜è®¤æƒ…å†µä¸‹æ²™ç®±å¯ä»¥ç¡®ä¿å•å®ä¾‹åœºæ™¯å­åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»ï¼Œä½†æ˜¯æ— æ³•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå­åº”ç”¨ã€æˆ–è€…å¤šå®ä¾‹åœºæ™¯çš„å­åº”ç”¨æ ·å¼éš”ç¦»ã€‚å½“é…ç½®ä¸º <code>{<!-- --> strictStyleIsolation: true <!-- -->}</code> æ—¶è¡¨ç¤ºå¼€å¯ä¸¥æ ¼çš„æ ·å¼éš”ç¦»æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼ä¸‹ qiankun ä¼šä¸ºæ¯ä¸ªå¾®åº”ç”¨çš„å®¹å™¨åŒ…è£¹ä¸Šä¸€ä¸ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/Web_Components/Using_shadow_DOM" target="_blank" rel="noopener noreferrer">shadow dom<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> èŠ‚ç‚¹ï¼Œä»è€Œç¡®ä¿å¾®åº”ç”¨çš„æ ·å¼ä¸ä¼šå¯¹å…¨å±€é€ æˆå½±å“ã€‚</p><div class="__dumi-default-alert">åŸºäº ShadowDOM çš„ä¸¥æ ¼æ ·å¼éš”ç¦»å¹¶ä¸æ˜¯ä¸€ä¸ªå¯ä»¥æ— è„‘ä½¿ç”¨çš„æ–¹æ¡ˆï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½éœ€è¦æ¥å…¥åº”ç”¨åšä¸€äº›é€‚é…åæ‰èƒ½æ­£å¸¸åœ¨ ShadowDOM ä¸­è¿è¡Œèµ·æ¥ï¼ˆæ¯”å¦‚ react åœºæ™¯ä¸‹éœ€è¦è§£å†³è¿™äº› <a target="_blank" href="https://github.com/facebook/react/issues/10422">é—®é¢˜</a>ï¼Œä½¿ç”¨è€…éœ€è¦æ¸…æ¥šå¼€å¯äº† <code>strictStyleIsolation</code> æ„å‘³ç€ä»€ä¹ˆã€‚åç»­ qiankun ä¼šæä¾›æ›´å¤šå®˜æ–¹å®è·µæ–‡æ¡£å¸®åŠ©ç”¨æˆ·èƒ½å¿«é€Ÿçš„å°†åº”ç”¨æ”¹é€ æˆå¯ä»¥è¿è¡Œåœ¨ ShadowDOM ç¯å¢ƒçš„å¾®åº”ç”¨ã€‚</div><p>é™¤æ­¤ä»¥å¤–ï¼Œqiankun è¿˜æä¾›äº†ä¸€ä¸ªå®éªŒæ€§çš„æ ·å¼éš”ç¦»ç‰¹æ€§ï¼Œå½“ experimentalStyleIsolation è¢«è®¾ç½®ä¸º true æ—¶ï¼Œqiankun ä¼šæ”¹å†™å­åº”ç”¨æ‰€æ·»åŠ çš„æ ·å¼ä¸ºæ‰€æœ‰æ ·å¼è§„åˆ™å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„é€‰æ‹©å™¨è§„åˆ™æ¥é™å®šå…¶å½±å“èŒƒå›´ï¼Œå› æ­¤æ”¹å†™åçš„ä»£ç ä¼šè¡¨è¾¾ç±»ä¼¼ä¸ºå¦‚ä¸‹ç»“æ„ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-unknown"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// å‡è®¾åŠ è½½çš„åº”ç”¨åä¸º react16
.app-main {
  font-size: 14px;
}

div[data-qiankun-react16] .app-main {
  font-size: 14px;
}
" data-status="copy"></button><div class="token-line"><span class="token plain">// å‡è®¾åŠ è½½çš„åº”ç”¨åä¸º react16</span></div><div class="token-line"><span class="token plain">.app-main {</span></div><div class="token-line"><span class="token plain">  font-size: 14px;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">div[data-qiankun-react16] .app-main {</span></div><div class="token-line"><span class="token plain">  font-size: 14px;</span></div><div class="token-line"><span class="token plain">}</span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>æ³¨æ„äº‹é¡¹: ç›®å‰ @keyframes, @font-face, @import, @page ç­‰è§„åˆ™ä¸ä¼šæ”¯æŒ (i.e. ä¸ä¼šè¢«æ”¹å†™)</p><p>åœ¨ç›®å‰é˜¶æ®µ, æˆ‘ä»¬è¿˜ä¸æ”¯æŒä»¥åŠ¨æ€çš„å¤–è”å½¢å¼ (<code>&lt;link /&gt;</code>) å½¢å¼åŠ å…¥çš„æ ·å¼ï¼Œä½†æˆ‘ä»¬è€ƒè™‘å°†æ¥æ”¯æŒè¿™ä¸€éƒ¨åˆ†ã€‚</p></li><li><p>singular - <code>boolean | ((app: RegistrableApp&lt;any&gt;) =&gt; Promise&lt;boolean&gt;);</code> - å¯é€‰ï¼Œæ˜¯å¦ä¸ºå•å®ä¾‹åœºæ™¯ï¼Œå•å®ä¾‹æŒ‡çš„æ˜¯åŒä¸€æ—¶é—´åªä¼šæ¸²æŸ“ä¸€ä¸ªå¾®åº”ç”¨ã€‚é»˜è®¤ä¸º <code>false</code>ã€‚</p></li><li><p>fetch - <code>Function</code> - å¯é€‰ï¼Œè‡ªå®šä¹‰çš„ fetch æ–¹æ³•ã€‚</p></li><li><p>getPublicPath - <code>(url: string) =&gt; string</code> - å¯é€‰</p></li><li><p>getTemplate - <code>(tpl: string) =&gt; string</code> - å¯é€‰</p></li><li><p>excludeAssetFilter - <code>(assetUrl: string) =&gt; boolean</code> - å¯é€‰ï¼ŒæŒ‡å®šéƒ¨åˆ†ç‰¹æ®Šçš„åŠ¨æ€åŠ è½½çš„å¾®åº”ç”¨èµ„æºï¼ˆcss/js) ä¸è¢«qiankun åŠ«æŒå¤„ç†</p></li></ul></li></ul></li><li><p>è¿”å›å€¼ - <code>MicroApp</code> - å¾®åº”ç”¨å®ä¾‹</p><ul><li>mount(): Promise&lt;null&gt;;</li><li>unmount(): Promise&lt;null&gt;;</li><li>update(customProps: object): Promise&lt;any&gt;;</li><li>getStatus(): | &quot;NOT_LOADED&quot; | &quot;LOADING_SOURCE_CODE&quot; | &quot;NOT_BOOTSTRAPPED&quot; | &quot;BOOTSTRAPPING&quot; | &quot;NOT_MOUNTED&quot; | &quot;MOUNTING&quot; | &quot;MOUNTED&quot; | &quot;UPDATING&quot; | &quot;UNMOUNTING&quot; | &quot;UNLOADING&quot; | &quot;SKIP_BECAUSE_BROKEN&quot; | &quot;LOAD_ERROR&quot;;</li><li>loadPromise: Promise&lt;null&gt;;</li><li>bootstrapPromise: Promise&lt;null&gt;;</li><li>mountPromise: Promise&lt;null&gt;;</li><li>unmountPromise: Promise&lt;null&gt;;</li></ul></li><li><p>ç”¨æ³•</p><p>æ‰‹åŠ¨åŠ è½½ä¸€ä¸ªå¾®åº”ç”¨ã€‚</p><p>å¦‚æœéœ€è¦èƒ½æ”¯æŒä¸»åº”ç”¨æ‰‹åŠ¨ update å¾®åº”ç”¨ï¼Œéœ€è¦å¾®åº”ç”¨ entry å†å¤šå¯¼å‡ºä¸€ä¸ª update é’©å­ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="export function mount(props) {
  renderApp(props);
}

// å¢åŠ  update é’©å­ä»¥ä¾¿ä¸»åº”ç”¨æ‰‹åŠ¨æ›´æ–°å¾®åº”ç”¨
export function update(props) {
  renderPatch(props);
}
" data-status="copy"></button><div class="token-line"><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">renderApp</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// å¢åŠ  update é’©å­ä»¥ä¾¿ä¸»åº”ç”¨æ‰‹åŠ¨æ›´æ–°å¾®åº”ç”¨</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">renderPatch</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { loadMicroApp } from &#x27;qiankun&#x27;;
import React from &#x27;react&#x27;;

class App extends React.Component {

  containerRef = React.createRef();
  microApp = null;

  componentDidMount() {
    this.microApp = loadMicroApp(
      { name: &#x27;app1&#x27;, entry: &#x27;//localhost:1234&#x27;, container: this.containerRef.current, props: { name: &#x27;qiankun&#x27; } },
    );
  }

  componentWillUnmount() {
    this.microApp.unmount();
  }

  componentDidUpdate() {
    this.microApp.update({ name: &#x27;kuitos&#x27; });
  }

  render() {
    return &lt;div ref={this.containerRef}&gt;&lt;/div&gt;;
  }
}
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> loadMicroApp </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> React </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">App</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation">.</span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  containerRef </span><span class="token operator">=</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  microApp </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">null</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">microApp </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">loadMicroApp</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> entry</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;//localhost:1234&#x27;</span><span class="token punctuation">,</span><span class="token plain"> container</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">containerRef</span><span class="token punctuation">.</span><span class="token plain">current</span><span class="token punctuation">,</span><span class="token plain"> props</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">microApp</span><span class="token punctuation">.</span><span class="token function">unmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">microApp</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;kuitos&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">containerRef</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h3 id="prefetchappsapps-importentryopts"><a aria-hidden="true" href="#prefetchappsapps-importentryopts"><span class="icon icon-link"></span></a><code>prefetchApps(apps, importEntryOpts?)</code></h3><ul><li><p>å‚æ•°</p><ul><li>apps - <code>AppMetadata[]</code> - å¿…é€‰ - é¢„åŠ è½½çš„åº”ç”¨åˆ—è¡¨</li><li>importEntryOpts - å¯é€‰ - åŠ è½½é…ç½®</li></ul></li><li><p>ç±»å‹</p><ul><li><code>AppMetadata</code><ul><li>name - <code>string</code> - å¿…é€‰ - åº”ç”¨å</li><li>entry - <code>string | <!-- -->{<!-- --> scripts?: string[]; styles?: string[]; html?: string <!-- -->}</code> - å¿…é€‰ï¼Œå¾®åº”ç”¨çš„ entry åœ°å€</li></ul></li></ul></li><li><p>ç”¨æ³•</p><p>æ‰‹åŠ¨é¢„åŠ è½½æŒ‡å®šçš„å¾®åº”ç”¨é™æ€èµ„æºã€‚ä»…æ‰‹åŠ¨åŠ è½½å¾®åº”ç”¨åœºæ™¯éœ€è¦ï¼ŒåŸºäºè·¯ç”±è‡ªåŠ¨æ¿€æ´»åœºæ™¯ç›´æ¥é…ç½® <code>prefetch</code> å±æ€§å³å¯ã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { prefetchApps } from &#x27;qiankun&#x27;;

prefetchApps([ { name: &#x27;app1&#x27;, entry: &#x27;//locahost:7001&#x27; }, { name: &#x27;app2&#x27;, entry: &#x27;//locahost:7002&#x27; } ])
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> prefetchApps </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">prefetchApps</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;app1&#x27;</span><span class="token punctuation">,</span><span class="token plain"> entry</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;//locahost:7001&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;app2&#x27;</span><span class="token punctuation">,</span><span class="token plain"> entry</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;//locahost:7002&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h2 id="adderrorhandlerremoveerrorhandler"><a aria-hidden="true" href="#adderrorhandlerremoveerrorhandler"><span class="icon icon-link"></span></a><a href="https://single-spa.js.org/docs/api#adderrorhandler" target="_blank" rel="noopener noreferrer">addErrorHandler/removeErrorHandler<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2><h2 id="addglobaluncaughterrorhandlerhandler"><a aria-hidden="true" href="#addglobaluncaughterrorhandlerhandler"><span class="icon icon-link"></span></a><code>addGlobalUncaughtErrorHandler(handler)</code></h2><ul><li><p>å‚æ•°</p><ul><li>handler - <code>(...args: any[]) =&gt; void</code> - å¿…é€‰</li></ul></li><li><p>ç”¨æ³•</p><p>æ·»åŠ å…¨å±€çš„æœªæ•è·å¼‚å¸¸å¤„ç†å™¨ã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { addGlobalUncaughtErrorHandler } from &#x27;qiankun&#x27;;

addGlobalUncaughtErrorHandler(event =&gt; console.log(event));
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> addGlobalUncaughtErrorHandler </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">addGlobalUncaughtErrorHandler</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">event</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h2 id="removeglobaluncaughterrorhandlerhandler"><a aria-hidden="true" href="#removeglobaluncaughterrorhandlerhandler"><span class="icon icon-link"></span></a><code>removeGlobalUncaughtErrorHandler(handler)</code></h2><ul><li><p>å‚æ•°</p><ul><li>handler - <code>(...args: any[]) =&gt; void</code> - å¿…é€‰</li></ul></li><li><p>ç”¨æ³•</p><p>ç§»é™¤å…¨å±€çš„æœªæ•è·å¼‚å¸¸å¤„ç†å™¨ã€‚</p></li><li><p>ç¤ºä¾‹</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { removeGlobalUncaughtErrorHandler } from &#x27;qiankun&#x27;;

removeGlobalUncaughtErrorHandler(handler);
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> removeGlobalUncaughtErrorHandler </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">removeGlobalUncaughtErrorHandler</span><span class="token punctuation">(</span><span class="token plain">handler</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul><h2 id="initglobalstatestate"><a aria-hidden="true" href="#initglobalstatestate"><span class="icon icon-link"></span></a><code>initGlobalState(state)</code></h2><ul><li><p>å‚æ•°</p><ul><li>state - <code>Record&lt;string, any&gt;</code> - å¿…é€‰</li></ul></li><li><p>ç”¨æ³•</p><p>å®šä¹‰å…¨å±€çŠ¶æ€ï¼Œå¹¶è¿”å›é€šä¿¡æ–¹æ³•ï¼Œå»ºè®®åœ¨ä¸»åº”ç”¨ä½¿ç”¨ï¼Œå¾®åº”ç”¨é€šè¿‡ props è·å–é€šä¿¡æ–¹æ³•ã€‚</p></li><li><p>è¿”å›</p><ul><li><p>MicroAppStateActions</p><ul><li><p>onGlobalStateChange: <code>(callback: OnGlobalStateChangeCallback, fireImmediately?: boolean) =&gt; void</code>ï¼Œ åœ¨å½“å‰åº”ç”¨ç›‘å¬å…¨å±€çŠ¶æ€ï¼Œæœ‰å˜æ›´è§¦å‘ callbackï¼ŒfireImmediately = true ç«‹å³è§¦å‘ callback</p></li><li><p>setGlobalState: <code>(state: Record&lt;string, any&gt;) =&gt; boolean</code>ï¼Œ æŒ‰ä¸€çº§å±æ€§è®¾ç½®å…¨å±€çŠ¶æ€ï¼Œå¾®åº”ç”¨ä¸­åªèƒ½ä¿®æ”¹å·²å­˜åœ¨çš„ä¸€çº§å±æ€§</p></li><li><p>offGlobalStateChange: <code>() =&gt; boolean</code>ï¼Œç§»é™¤å½“å‰åº”ç”¨çš„çŠ¶æ€ç›‘å¬ï¼Œå¾®åº”ç”¨ umount æ—¶ä¼šé»˜è®¤è°ƒç”¨</p></li></ul></li></ul></li><li><p>ç¤ºä¾‹</p><p>ä¸»åº”ç”¨ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import { initGlobalState, MicroAppStateActions } from &#x27;qiankun&#x27;;

// åˆå§‹åŒ– state
const actions: MicroAppStateActions = initGlobalState(state);

actions.onGlobalStateChange((state, prev) =&gt; {
  // state: å˜æ›´åçš„çŠ¶æ€; prev å˜æ›´å‰çš„çŠ¶æ€
  console.log(state, prev);
});
actions.setGlobalState(state);
actions.offGlobalStateChange();
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> initGlobalState</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">MicroAppStateActions</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;qiankun&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// åˆå§‹åŒ– state</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> actions</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">MicroAppStateActions</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">initGlobalState</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">actions</span><span class="token punctuation">.</span><span class="token method function property-access">onGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token parameter punctuation">,</span><span class="token parameter"> prev</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// state: å˜æ›´åçš„çŠ¶æ€; prev å˜æ›´å‰çš„çŠ¶æ€</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> prev</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">actions</span><span class="token punctuation">.</span><span class="token method function property-access">setGlobalState</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">actions</span><span class="token punctuation">.</span><span class="token method function property-access">offGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>å¾®åº”ç”¨ï¼š</p><div class="__dumi-default-code-block"><pre class="prism-code language-ts"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// ä»ç”Ÿå‘½å‘¨æœŸ mount ä¸­è·å–é€šä¿¡æ–¹æ³•ï¼Œä½¿ç”¨æ–¹å¼å’Œ master ä¸€è‡´
export function mount(props) {

  props.onGlobalStateChange((state, prev) =&gt; {
    // state: å˜æ›´åçš„çŠ¶æ€; prev å˜æ›´å‰çš„çŠ¶æ€
    console.log(state, prev);
  });

  props.setGlobalState(state);
}
" data-status="copy"></button><div class="token-line"><span class="token comment">// ä»ç”Ÿå‘½å‘¨æœŸ mount ä¸­è·å–é€šä¿¡æ–¹æ³•ï¼Œä½¿ç”¨æ–¹å¼å’Œ master ä¸€è‡´</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  props</span><span class="token punctuation">.</span><span class="token method function property-access">onGlobalStateChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token parameter punctuation">,</span><span class="token parameter"> prev</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// state: å˜æ›´åçš„çŠ¶æ€; prev å˜æ›´å‰çš„çŠ¶æ€</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> prev</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  props</span><span class="token punctuation">.</span><span class="token method function property-access">setGlobalState</span><span class="token punctuation">(</span><span class="token plain">state</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/kuitos/qiankun/edit/master/docs/api/README.zh.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">7/15/2020, 11:32:01 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script>
      (function () {
        if (!location.port) {
          (function (i, s, o, g, r, a, m) {
            i["GoogleAnalyticsObject"] = r;
            (i[r] =
              i[r] ||
              function () {
                (i[r].q = i[r].q || []).push(arguments);
              }),
              (i[r].l = 1 * new Date());
            (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m);
          })(
            window,
            document,
            "script",
            "//www.google-analytics.com/analytics.js",
            "ga"
          );
          ga("create", "UA-157295698-1", "auto");
          ga("send", "pageview");
        }
      })();
    </script>
    <script src="/qiankun/umi.40c236b7.js"></script>
  </body>
</html>
