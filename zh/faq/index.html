<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¸¸è§é—®é¢˜ | qiankun</title>
    <meta name="generator" content="VuePress 1.4.1">
    <script>
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?0f738d9b0ac90574c09183ea85bcfa2e";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      </script>
    <meta name="description" content="å¯èƒ½æ˜¯ä½ è§è¿‡æœ€å®Œå–„çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆğŸ§">
    <meta name="keywords" content="microfrontend, micro frontend, micro frontends, micro-frontend, micro-frontends, microservice, javascript">
    <link rel="preload" href="/qiankun/assets/css/0.styles.b60dbe72.css" as="style"><link rel="preload" href="/qiankun/assets/js/app.5b918351.js" as="script"><link rel="preload" href="/qiankun/assets/js/2.b25794af.js" as="script"><link rel="preload" href="/qiankun/assets/js/13.881fc36e.js" as="script"><link rel="preload" href="/qiankun/assets/js/3.0164b3a4.js" as="script"><link rel="prefetch" href="/qiankun/assets/js/10.6499211f.js"><link rel="prefetch" href="/qiankun/assets/js/11.1efbb372.js"><link rel="prefetch" href="/qiankun/assets/js/12.834b3b97.js"><link rel="prefetch" href="/qiankun/assets/js/14.f82c43f9.js"><link rel="prefetch" href="/qiankun/assets/js/15.a66b636b.js"><link rel="prefetch" href="/qiankun/assets/js/16.abaaecdb.js"><link rel="prefetch" href="/qiankun/assets/js/17.8b2925ac.js"><link rel="prefetch" href="/qiankun/assets/js/4.3ae9d82a.js"><link rel="prefetch" href="/qiankun/assets/js/5.23910528.js"><link rel="prefetch" href="/qiankun/assets/js/6.4ea80c66.js"><link rel="prefetch" href="/qiankun/assets/js/7.55c9405f.js"><link rel="prefetch" href="/qiankun/assets/js/8.506b9ab1.js"><link rel="prefetch" href="/qiankun/assets/js/9.cb2f04b2.js">
    <link rel="stylesheet" href="/qiankun/assets/css/0.styles.b60dbe72.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qiankun/zh/" class="home-link router-link-active"><!----> <span class="site-name">qiankun</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/qiankun/zh/guide/" class="nav-link">
  æŒ‡å—
</a></div><div class="nav-item"><a href="/qiankun/zh/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/qiankun/zh/faq/" class="nav-link router-link-exact-active router-link-active">
  å¸¸è§é—®é¢˜
</a></div><div class="nav-item"><a href="https://github.com/umijs/qiankun/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‘å¸ƒæ—¥å¿—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://v1.qiankun.umijs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.x
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qiankun/faq/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/qiankun/zh/faq/" class="nav-link router-link-exact-active router-link-active">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <a href="https://github.com/umijs/qiankun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/qiankun/zh/guide/" class="nav-link">
  æŒ‡å—
</a></div><div class="nav-item"><a href="/qiankun/zh/api/" class="nav-link">
  API
</a></div><div class="nav-item"><a href="/qiankun/zh/faq/" class="nav-link router-link-exact-active router-link-active">
  å¸¸è§é—®é¢˜
</a></div><div class="nav-item"><a href="https://github.com/umijs/qiankun/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  å‘å¸ƒæ—¥å¿—
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://v1.qiankun.umijs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  1.x
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">é€‰æ‹©è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qiankun/faq/" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/qiankun/zh/faq/" class="nav-link router-link-exact-active router-link-active">
  ç®€ä½“ä¸­æ–‡
</a></li></ul></div></div> <a href="https://github.com/umijs/qiankun" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/qiankun/zh/faq/" class="active sidebar-link">å¸¸è§é—®é¢˜</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#application-died-in-status-loading-source-code-you-need-to-export-the-functional-lifecycles-in-xxx-entry" class="sidebar-link">Application died in status LOADING_SOURCE_CODE: You need to export the functional lifecycles in xxx entry</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#vue-router-æŠ¥é”™-uncaught-typeerror-cannot-redefine-property-router" class="sidebar-link">Vue Router æŠ¥é”™ Uncaught TypeError: Cannot redefine property: $router</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#ä¸ºä»€ä¹ˆå¾®åº”ç”¨åŠ è½½çš„èµ„æºä¼š-404ï¼Ÿ" class="sidebar-link">ä¸ºä»€ä¹ˆå¾®åº”ç”¨åŠ è½½çš„èµ„æºä¼š 404ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#å¾®åº”ç”¨é™æ€èµ„æºä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ" class="sidebar-link">å¾®åº”ç”¨é™æ€èµ„æºä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#å¦‚ä½•è§£å†³ç”±äºè¿è¥å•†åŠ¨æ€æ’å…¥çš„è„šæœ¬åŠ è½½å¼‚å¸¸å¯¼è‡´å¾®åº”ç”¨åŠ è½½å¤±è´¥çš„é—®é¢˜" class="sidebar-link">å¦‚ä½•è§£å†³ç”±äºè¿è¥å•†åŠ¨æ€æ’å…¥çš„è„šæœ¬åŠ è½½å¼‚å¸¸å¯¼è‡´å¾®åº”ç”¨åŠ è½½å¤±è´¥çš„é—®é¢˜</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#å¦‚ä½•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»" class="sidebar-link">å¦‚ä½•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#å¦‚ä½•ç‹¬ç«‹è¿è¡Œå¾®åº”ç”¨ï¼Ÿ" class="sidebar-link">å¦‚ä½•ç‹¬ç«‹è¿è¡Œå¾®åº”ç”¨ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#å¦‚ä½•åŒæ—¶æ¿€æ´»ä¸¤ä¸ªå¾®åº”ç”¨ï¼Ÿ" class="sidebar-link">å¦‚ä½•åŒæ—¶æ¿€æ´»ä¸¤ä¸ªå¾®åº”ç”¨ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#å¦‚ä½•æå–å‡ºå…¬å…±çš„ä¾èµ–åº“ï¼Ÿ" class="sidebar-link">å¦‚ä½•æå–å‡ºå…¬å…±çš„ä¾èµ–åº“ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#qiankun-èƒ½å…¼å®¹-ie-å—ï¼Ÿ" class="sidebar-link">qiankun èƒ½å…¼å®¹ ie å—ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/qiankun/zh/faq/#é-webpack-æ„å»ºçš„å¾®åº”ç”¨æ”¯æŒæ¥å…¥-qiankun-ä¹ˆï¼Ÿ" class="sidebar-link">é webpack æ„å»ºçš„å¾®åº”ç”¨æ”¯æŒæ¥å…¥ qiankun ä¹ˆï¼Ÿ</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="header-anchor">#</a> å¸¸è§é—®é¢˜</h1> <h2 id="application-died-in-status-loading-source-code-you-need-to-export-the-functional-lifecycles-in-xxx-entry"><a href="#application-died-in-status-loading-source-code-you-need-to-export-the-functional-lifecycles-in-xxx-entry" class="header-anchor">#</a> <code>Application died in status LOADING_SOURCE_CODE: You need to export the functional lifecycles in xxx entry</code></h2> <p>qiankun æŠ›å‡ºè¿™ä¸ªé”™è¯¯æ˜¯å› ä¸ºæ— æ³•ä»å¾®åº”ç”¨çš„ entry js ä¸­è¯†åˆ«å‡ºå…¶å¯¼å‡ºçš„ç”Ÿå‘½å‘¨æœŸé’©å­ã€‚</p> <p>å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p> <ol><li><p>æ£€æŸ¥å¾®åº”ç”¨æ˜¯å¦å·²ç»å¯¼å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œå‚è€ƒ<a href="/qiankun/zh/guide/getting-started.html#_1-å¯¼å‡ºç›¸åº”çš„ç”Ÿå‘½å‘¨æœŸé’©å­">æ–‡æ¡£</a>ã€‚</p></li> <li><p>æ£€æŸ¥å¾®åº”ç”¨çš„ webpack æ˜¯å¦å¢åŠ äº†æŒ‡å®šçš„é…ç½®ï¼Œå‚è€ƒ<a href="/qiankun/zh/guide/getting-started.html#_2-é…ç½®å¾®åº”ç”¨çš„æ‰“åŒ…å·¥å…·">æ–‡æ¡£</a>ã€‚</p></li> <li><p>æ£€æŸ¥å¾®åº”ç”¨çš„ <code>package.json</code> ä¸­çš„ <code>name</code> å­—æ®µæ˜¯å¦æ˜¯å¾®åº”ç”¨ä¸­å”¯ä¸€çš„ã€‚</p></li> <li><p>æ£€æŸ¥å¾®åº”ç”¨çš„ entry html ä¸­å…¥å£çš„ js æ˜¯ä¸æ˜¯æœ€åä¸€ä¸ªåŠ è½½çš„è„šæœ¬ã€‚å¦‚æœä¸æ˜¯ï¼Œéœ€è¦ç§»åŠ¨é¡ºåºå°†å…¶å˜æˆæœ€åä¸€ä¸ªåŠ è½½çš„ jsï¼Œæˆ–è€…åœ¨ html ä¸­å°†å…¥å£ js æ‰‹åŠ¨æ ‡è®°ä¸º <code>entry</code>ï¼Œå¦‚ï¼š</p> <div class="language-html extra-class"><div class="highlight-lines"><br><div class="highlighted">Â </div><br><br></div><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/antd.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>/appEntry.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">entry</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>https://www.google.com/analytics.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></li></ol> <p>å¦‚æœåœ¨ä¸Šè¿°æ­¥éª¤å®Œæˆåä»æœ‰é—®é¢˜ï¼Œé€šå¸¸è¯´æ˜æ˜¯æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜å¯¼è‡´çš„ã€‚å¯ä»¥å°è¯• <strong>å°†æœ‰é—®é¢˜çš„å¾®åº”ç”¨çš„ webpack <code>output.library</code> é…ç½®æˆè·Ÿä¸»åº”ç”¨ä¸­æ³¨å†Œçš„ <code>name</code> å­—æ®µä¸€è‡´</strong>ï¼Œå¦‚ï¼š</p> <p>å‡å¦‚ä¸»åº”ç”¨é…ç½®æ˜¯è¿™æ ·çš„ï¼š</p> <div class="language-ts extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br><br></div><pre class="language-ts"><code><span class="token comment">// ä¸»åº”ç”¨</span>
<span class="token function">registerMicroApps</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'brokenSubApp'</span><span class="token punctuation">,</span>
    entry<span class="token operator">:</span> <span class="token string">'//localhost:7100'</span><span class="token punctuation">,</span>
    container<span class="token operator">:</span> <span class="token string">'#yourContainer'</span><span class="token punctuation">,</span>
    activeRule<span class="token operator">:</span> <span class="token string">'/react'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å°†å¾®åº”ç”¨çš„ <code>output.library</code> æ”¹ä¸ºè·Ÿä¸»åº”ç”¨ä¸­æ³¨å†Œçš„ä¸€è‡´ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><br><br><div class="highlighted">Â </div><br><br><br><br><br></div><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¿™é‡Œæ”¹æˆè·Ÿä¸»åº”ç”¨ä¸­æ³¨å†Œçš„ä¸€è‡´</span>
    library<span class="token operator">:</span> <span class="token string">'brokenSubApp'</span><span class="token punctuation">,</span>
    libraryTarget<span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
    jsonpFunction<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">webpackJsonp_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>packageName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="vue-router-æŠ¥é”™-uncaught-typeerror-cannot-redefine-property-router"><a href="#vue-router-æŠ¥é”™-uncaught-typeerror-cannot-redefine-property-router" class="header-anchor">#</a> Vue Router æŠ¥é”™ <code>Uncaught TypeError: Cannot redefine property: $router</code></h2> <p>qiankun ä¸­çš„ä»£ç ä½¿ç”¨ Proxy å»ä»£ç†çˆ¶é¡µé¢çš„ windowï¼Œæ¥å®ç°çš„æ²™ç®±ï¼Œåœ¨å¾®åº”ç”¨ä¸­è®¿é—® <code>window.Vue</code> æ—¶ï¼Œä¼šå…ˆåœ¨è‡ªå·±çš„ window é‡ŒæŸ¥æ‰¾æœ‰æ²¡æœ‰ <code>Vue</code> å±æ€§ï¼Œå¦‚æœæ²¡æœ‰å°±å»çˆ¶åº”ç”¨é‡ŒæŸ¥æ‰¾ã€‚</p> <p>åœ¨ VueRouter çš„ä»£ç é‡Œæœ‰è¿™æ ·ä¸‰è¡Œä»£ç ï¼Œä¼šåœ¨æ¨¡å—åŠ è½½çš„æ—¶å€™å°±è®¿é—® <code>window.Vue</code> è¿™ä¸ªå˜é‡ï¼Œå­é¡¹ç›®ä¸­æŠ¥è¿™ä¸ªé”™ï¼Œä¸€èˆ¬æ˜¯ç”±äºçˆ¶åº”ç”¨ä¸­çš„ Vue æŒ‚è½½åˆ°äº†çˆ¶åº”ç”¨çš„ <code>window</code> å¯¹è±¡ä¸Šäº†ã€‚</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>inBrowser <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span>Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueRouter<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥ä»ä»¥ä¸‹æ–¹å¼ä¸­é€‰æ‹©ä¸€ç§æ¥è§£å†³é—®é¢˜ï¼š</p> <ol><li>åœ¨ä¸»åº”ç”¨ä¸­ä¸ä½¿ç”¨ CDN ç­‰ external çš„æ–¹å¼æ¥åŠ è½½ <code>Vue</code> æ¡†æ¶ï¼Œä½¿ç”¨å‰ç«¯æ‰“åŒ…è½¯ä»¶æ¥åŠ è½½æ¨¡å—</li> <li>åœ¨ä¸»åº”ç”¨ä¸­ï¼Œå°† <code>window.Vue</code> å˜é‡æ”¹ä¸ªåç§°ï¼Œä¾‹å¦‚ <code>window.Vue2 = window.Vue; window.Vue = undefined</code></li></ol> <h2 id="ä¸ºä»€ä¹ˆå¾®åº”ç”¨åŠ è½½çš„èµ„æºä¼š-404ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆå¾®åº”ç”¨åŠ è½½çš„èµ„æºä¼š-404ï¼Ÿ" class="header-anchor">#</a> ä¸ºä»€ä¹ˆå¾®åº”ç”¨åŠ è½½çš„èµ„æºä¼š 404ï¼Ÿ</h2> <p>åŸå› æ˜¯ webpack åŠ è½½èµ„æºæ—¶æœªä½¿ç”¨æ­£ç¡®çš„ <code>publicPath</code>ã€‚</p> <p>å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p> <h3 id="a-ä½¿ç”¨-webpack-è¿è¡Œæ—¶-publicpath-é…ç½®"><a href="#a-ä½¿ç”¨-webpack-è¿è¡Œæ—¶-publicpath-é…ç½®" class="header-anchor">#</a> a. ä½¿ç”¨ webpack è¿è¡Œæ—¶ publicPath é…ç½®</h3> <p>qiankun å°†ä¼šåœ¨å¾®åº”ç”¨ bootstrap ä¹‹å‰æ³¨å…¥ä¸€ä¸ªè¿è¡Œæ—¶çš„ publicPath å˜é‡ï¼Œä½ éœ€è¦åšçš„æ˜¯åœ¨å¾®åº”ç”¨çš„ entry js çš„é¡¶éƒ¨æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>__webpack_public_path__ <span class="token operator">=</span> window<span class="token punctuation">.</span>__INJECTED_PUBLIC_PATH_BY_QIANKUN__<span class="token punctuation">;</span>
</code></pre></div><p>å…³äºè¿è¡Œæ—¶ publicPath çš„æŠ€æœ¯ç»†èŠ‚ï¼Œå¯ä»¥å‚è€ƒ <a href="https://webpack.js.org/guides/public-path/#on-the-fly" target="_blank" rel="noopener noreferrer">webpack æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <div class="custom-block tip"><p class="custom-block-title">æç¤º</p> <p>runtime publicPath ä¸»è¦è§£å†³çš„æ˜¯å¾®åº”ç”¨åŠ¨æ€è½½å…¥çš„ è„šæœ¬ã€æ ·å¼ã€å›¾ç‰‡ ç­‰åœ°å€ä¸æ­£ç¡®çš„é—®é¢˜ã€‚</p></div> <h3 id="b-ä½¿ç”¨-webpack-é™æ€-publicpath-é…ç½®"><a href="#b-ä½¿ç”¨-webpack-é™æ€-publicpath-é…ç½®" class="header-anchor">#</a> b. ä½¿ç”¨ webpack é™æ€ publicPath é…ç½®</h3> <p>ä½ éœ€è¦å°†ä½ çš„ webpack <code>publicPath</code> é…ç½®è®¾ç½®æˆä¸€ä¸ªç»å¯¹åœ°å€çš„ urlï¼Œæ¯”å¦‚åœ¨å¼€å‘ç¯å¢ƒå¯èƒ½æ˜¯ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  output<span class="token operator">:</span> <span class="token punctuation">{</span>
    publicPath<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">//localhost:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>port<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="å¾®åº”ç”¨é™æ€èµ„æºä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ"><a href="#å¾®åº”ç”¨é™æ€èµ„æºä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ" class="header-anchor">#</a> å¾®åº”ç”¨é™æ€èµ„æºä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ</h2> <p>æ˜¯çš„ã€‚</p> <p>ç”±äº qiankun æ˜¯é€šè¿‡ fetch å»è·å–å¾®åº”ç”¨çš„å¼•å…¥çš„é™æ€èµ„æºçš„ï¼Œæ‰€ä»¥å¿…é¡»è¦æ±‚è¿™äº›é™æ€èµ„æºæ”¯æŒ<a href="https://developer.mozilla.org/zh/docs/Web/HTTP/Access_control_CORS" target="_blank" rel="noopener noreferrer">è·¨åŸŸ<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ã€‚</p> <p>å¦‚æœæ˜¯è‡ªå·±çš„è„šæœ¬ï¼Œå¯ä»¥é€šè¿‡å¼€å‘æœåŠ¡ç«¯è·¨åŸŸæ¥æ”¯æŒã€‚å¦‚æœæ˜¯ä¸‰æ–¹è„šæœ¬ä¸”æ— æ³•ä¸ºå…¶æ·»åŠ è·¨åŸŸå¤´ï¼Œå¯ä»¥å°†è„šæœ¬æ‹–åˆ°æœ¬åœ°ï¼Œç”±è‡ªå·±çš„æœåŠ¡å™¨ serve æ¥æ”¯æŒè·¨åŸŸã€‚</p> <p>å‚è€ƒï¼š<a href="https://segmentfault.com/a/1190000012550346" target="_blank" rel="noopener noreferrer">Nginx è·¨åŸŸé…ç½®<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="å¦‚ä½•è§£å†³ç”±äºè¿è¥å•†åŠ¨æ€æ’å…¥çš„è„šæœ¬åŠ è½½å¼‚å¸¸å¯¼è‡´å¾®åº”ç”¨åŠ è½½å¤±è´¥çš„é—®é¢˜"><a href="#å¦‚ä½•è§£å†³ç”±äºè¿è¥å•†åŠ¨æ€æ’å…¥çš„è„šæœ¬åŠ è½½å¼‚å¸¸å¯¼è‡´å¾®åº”ç”¨åŠ è½½å¤±è´¥çš„é—®é¢˜" class="header-anchor">#</a> å¦‚ä½•è§£å†³ç”±äºè¿è¥å•†åŠ¨æ€æ’å…¥çš„è„šæœ¬åŠ è½½å¼‚å¸¸å¯¼è‡´å¾®åº”ç”¨åŠ è½½å¤±è´¥çš„é—®é¢˜</h2> <p>è¿è¥å•†æ’å…¥çš„è„šæœ¬é€šå¸¸ä¼šç”¨ async æ ‡è®°ä»è€Œé¿å… block å¾®åº”ç”¨çš„åŠ è½½ï¼Œè¿™ç§é€šå¸¸æ²¡é—®é¢˜ï¼Œå¦‚ï¼š</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">async</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>//www.rogue.com/rogue.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>ä½†å¦‚æœæœ‰äº›æ’å…¥çš„è„šæœ¬ä¸æ˜¯è¢«æ ‡è®°æˆ async çš„ï¼Œè¿™ç±»è„šæœ¬ä¸€æ—¦è¿è¡Œå¤±è´¥ï¼Œå°†ä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨è¢« block ä¸”åç»­çš„è„šæœ¬ä¹Ÿä¸å†æ‰§è¡Œã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ä¸ªæ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p> <h3 id="ä½¿ç”¨è‡ªå®šä¹‰çš„-gettemplate-æ–¹æ³•"><a href="#ä½¿ç”¨è‡ªå®šä¹‰çš„-gettemplate-æ–¹æ³•" class="header-anchor">#</a> ä½¿ç”¨è‡ªå®šä¹‰çš„ getTemplate æ–¹æ³•</h3> <p>é€šè¿‡è‡ªå·±å®ç°çš„ getTemplate æ–¹æ³•è¿‡æ»¤å¾®åº”ç”¨ HTML æ¨¡æ¿ä¸­çš„å¼‚å¸¸è„šæœ¬</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> start <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">getTemplate</span><span class="token punctuation">(</span><span class="token parameter">tpl</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> tpl<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'&lt;script src=&quot;/to-be-replaced.js&quot;&gt;&lt;script&gt;'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="ä½¿ç”¨è‡ªå®šä¹‰çš„-fetch-æ–¹æ³•"><a href="#ä½¿ç”¨è‡ªå®šä¹‰çš„-fetch-æ–¹æ³•" class="header-anchor">#</a> ä½¿ç”¨è‡ªå®šä¹‰çš„ fetch æ–¹æ³•</h3> <p>é€šè¿‡è‡ªå·±å®ç°çš„ fetch æ–¹æ³•æ‹¦æˆªæœ‰é—®é¢˜çš„è„šæœ¬</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> start <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'qiankun'</span><span class="token punctuation">;</span>

<span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token parameter">url<span class="token punctuation">,</span> <span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">'http://to-be-replaced.js'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token keyword">async</span> <span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token string">''</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> window<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="å°†å¾®åº”ç”¨çš„-html-çš„-response-content-type-æ”¹ä¸º-text-plainï¼ˆç»ˆææ–¹æ¡ˆï¼‰"><a href="#å°†å¾®åº”ç”¨çš„-html-çš„-response-content-type-æ”¹ä¸º-text-plainï¼ˆç»ˆææ–¹æ¡ˆï¼‰" class="header-anchor">#</a> å°†å¾®åº”ç”¨çš„ HTML çš„ response content-type æ”¹ä¸º text/plainï¼ˆç»ˆææ–¹æ¡ˆï¼‰</h3> <p>åŸç†æ˜¯è¿è¥å•†åªèƒ½è¯†åˆ« response content-type ä¸º text/html çš„è¯·æ±‚å¹¶æ’å…¥è„šæœ¬ï¼Œtext/plain ç±»å‹çš„å“åº”åˆ™ä¸ä¼šè¢«åŠ«æŒã€‚</p> <p>ä¿®æ”¹å¾®åº”ç”¨ HTML çš„ content-type æ–¹æ³•å¯ä»¥è‡ªè¡Œ googleï¼Œä¹Ÿæœ‰ä¸€ä¸ªæ›´ç®€å•é«˜æ•ˆçš„æ–¹æ¡ˆï¼š</p> <ol><li><p>å¾®åº”ç”¨å‘å¸ƒæ—¶ä» index.html å¤åˆ¶å‡ºä¸€ä¸ª index.txt æ–‡ä»¶å‡ºæ¥</p></li> <li><p>å°†ä¸»åº”ç”¨ä¸­çš„ entry æ”¹ä¸º txt åœ°å€ï¼Œå¦‚ï¼š</p> <div class="language-diff extra-class"><pre class="language-diff"><code>registerMicroApps(
<span class="token unchanged">  [
</span><span class="token deleted-sign deleted">-    { name: 'app1', entry: '//localhost:8080/index.html', container, activeRule },
</span><span class="token inserted-sign inserted">+    { name: 'app1', entry: '//localhost:8080/index.txt', container, activeRule },
</span><span class="token unchanged">  ],
</span>);
</code></pre></div></li></ol> <h2 id="å¦‚ä½•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»"><a href="#å¦‚ä½•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»" class="header-anchor">#</a> å¦‚ä½•ç¡®ä¿ä¸»åº”ç”¨è·Ÿå¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»</h2> <p>qiankun å°†ä¼šè‡ªåŠ¨éš”ç¦»å¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼ï¼ˆå¼€å¯æ²™ç®±çš„æƒ…å†µä¸‹ï¼‰ï¼Œä½ å¯ä»¥é€šè¿‡æ‰‹åŠ¨çš„æ–¹å¼ç¡®ä¿ä¸»åº”ç”¨ä¸å¾®åº”ç”¨ä¹‹é—´çš„æ ·å¼éš”ç¦»ã€‚æ¯”å¦‚ç»™ä¸»åº”ç”¨çš„æ‰€æœ‰æ ·å¼æ·»åŠ ä¸€ä¸ªå‰ç¼€ï¼Œæˆ–è€…å‡å¦‚ä½ ä½¿ç”¨äº† <a href="https://ant.design" target="_blank" rel="noopener noreferrer">ant-design<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> è¿™æ ·çš„ç»„ä»¶åº“ï¼Œä½ å¯ä»¥é€šè¿‡<a href="https://ant.design/docs/react/customize-theme" target="_blank" rel="noopener noreferrer">è¿™ç¯‡æ–‡æ¡£<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>ä¸­çš„é…ç½®æ–¹å¼ç»™ä¸»åº”ç”¨æ ·å¼è‡ªåŠ¨æ·»åŠ æŒ‡å®šçš„å‰ç¼€ã€‚</p> <h2 id="å¦‚ä½•ç‹¬ç«‹è¿è¡Œå¾®åº”ç”¨ï¼Ÿ"><a href="#å¦‚ä½•ç‹¬ç«‹è¿è¡Œå¾®åº”ç”¨ï¼Ÿ" class="header-anchor">#</a> å¦‚ä½•ç‹¬ç«‹è¿è¡Œå¾®åº”ç”¨ï¼Ÿ</h2> <p>æœ‰äº›æ—¶å€™æˆ‘ä»¬å¸Œæœ›ç›´æ¥å¯åŠ¨å¾®åº”ç”¨ä»è€Œæ›´æ–¹ä¾¿çš„å¼€å‘è°ƒè¯•ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸ªå…¨å±€å˜é‡æ¥åŒºåˆ†å½“å‰æ˜¯å¦è¿è¡Œåœ¨ qiankun çš„ä¸»åº”ç”¨çš„ä¸Šä¸‹æ–‡ä¸­ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">.</span>__POWERED_BY_QIANKUN__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">mount</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="å¦‚ä½•åŒæ—¶æ¿€æ´»ä¸¤ä¸ªå¾®åº”ç”¨ï¼Ÿ"><a href="#å¦‚ä½•åŒæ—¶æ¿€æ´»ä¸¤ä¸ªå¾®åº”ç”¨ï¼Ÿ" class="header-anchor">#</a> å¦‚ä½•åŒæ—¶æ¿€æ´»ä¸¤ä¸ªå¾®åº”ç”¨ï¼Ÿ</h2> <p>å¾®åº”ç”¨ä½•æ—¶è¢«æ¿€æ´»å®Œå…¨å–å†³äºä½ çš„ <code>activeRule</code> é…ç½®ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬å°† <code>reactApp</code> å’Œ <code>react15App</code> çš„ <code>activeRule</code> é€»è¾‘è®¾ç½®æˆä¸€è‡´çš„ï¼š</p> <div class="language-js extra-class"><div class="highlight-lines"><br><div class="highlighted">Â </div><div class="highlighted">Â </div><br><br><br><div class="highlighted">Â </div><br></div><pre class="language-js"><code><span class="token function">registerMicroApps</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'reactApp'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//localhost:7100'</span><span class="token punctuation">,</span> container<span class="token punctuation">,</span> <span class="token function-variable function">activeRule</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">isReactApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'react15App'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//localhost:7102'</span><span class="token punctuation">,</span> container<span class="token punctuation">,</span> <span class="token function-variable function">activeRule</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">isReactApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'vueApp'</span><span class="token punctuation">,</span> entry<span class="token operator">:</span> <span class="token string">'//localhost:7101'</span><span class="token punctuation">,</span> container<span class="token punctuation">,</span> <span class="token function-variable function">activeRule</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">isVueApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">{</span> singular<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å½“åœ¨ <code>start</code> æ–¹æ³•ä¸­é…ç½®å¥½ <code>singular: false</code> åï¼Œåªè¦ <code>isReactApp()</code> è¿”å› <code>true</code> æ—¶ï¼Œ<code>reactApp</code> å’Œ <code>react15App</code> å°†ä¼šåŒæ—¶è¢« mountã€‚</p> <div class="custom-block warning"><p class="custom-block-title">æ³¨æ„</p> <p>é¡µé¢ä¸Šä¸èƒ½åŒæ—¶æ˜¾ç¤ºå¤šä¸ªä¾èµ–äºè·¯ç”±çš„å¾®åº”ç”¨ï¼Œå› ä¸ºæµè§ˆå™¨åªæœ‰ä¸€ä¸ª urlï¼Œå¦‚æœæœ‰å¤šä¸ªä¾èµ–è·¯ç”±çš„å¾®åº”ç”¨åŒæ—¶è¢«æ¿€æ´»ï¼Œé‚£ä¹ˆå¿…å®šä¼šå¯¼è‡´å…¶ä¸­ä¸€ä¸ª 404ã€‚</p></div> <h2 id="å¦‚ä½•æå–å‡ºå…¬å…±çš„ä¾èµ–åº“ï¼Ÿ"><a href="#å¦‚ä½•æå–å‡ºå…¬å…±çš„ä¾èµ–åº“ï¼Ÿ" class="header-anchor">#</a> å¦‚ä½•æå–å‡ºå…¬å…±çš„ä¾èµ–åº“ï¼Ÿ</h2> <blockquote><p>ä¸è¦å…±äº«è¿è¡Œæ—¶ï¼Œå³ä¾¿æ‰€æœ‰çš„å›¢é˜Ÿéƒ½æ˜¯ç”¨åŒä¸€ä¸ªæ¡†æ¶ã€‚- <a href="https://micro-frontends.org/" target="_blank" rel="noopener noreferrer">å¾®å‰ç«¯<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p>è™½ç„¶å…±äº«ä¾èµ–å¹¶ä¸å»ºè®®ï¼Œä½†å¦‚æœä½ çœŸçš„æœ‰è¿™ä¸ªéœ€æ±‚ï¼Œä½ å¯ä»¥åœ¨å¾®åº”ç”¨ä¸­å°†å…¬å…±ä¾èµ–é…ç½®æˆ <code>external</code>ï¼Œç„¶ååœ¨ä¸»åº”ç”¨ä¸­å¯¼å…¥è¿™äº›å…¬å…±ä¾èµ–ã€‚</p> <p>qiankun 2.0 ç‰ˆæœ¬å°†æä¾›ä¸€ç§æ›´æ™ºèƒ½çš„æ–¹å¼ä½¿å…¶è‡ªåŠ¨åŒ–ã€‚</p> <h2 id="qiankun-èƒ½å…¼å®¹-ie-å—ï¼Ÿ"><a href="#qiankun-èƒ½å…¼å®¹-ie-å—ï¼Ÿ" class="header-anchor">#</a> qiankun èƒ½å…¼å®¹ ie å—ï¼Ÿ</h2> <blockquote><p>å…¼å®¹.</p></blockquote> <p>ä½†æ˜¯ IE ç¯å¢ƒä¸‹ï¼ˆä¸æ”¯æŒ Proxy çš„æµè§ˆå™¨ï¼‰åªèƒ½ä½¿ç”¨å•å®ä¾‹æ¨¡å¼ï¼Œå³ <code>singular</code> é…ç½®ä¼šè¢«è‡ªåŠ¨ç½®ä¸º <code>true</code>ã€‚</p> <p>ä½ å¯ä»¥åœ¨<a href="/qiankun/zh/api/#start-opts">è¿™é‡Œ</a>æ‰¾åˆ° singular ç›¸å…³è¯´æ˜ã€‚</p> <h2 id="é-webpack-æ„å»ºçš„å¾®åº”ç”¨æ”¯æŒæ¥å…¥-qiankun-ä¹ˆï¼Ÿ"><a href="#é-webpack-æ„å»ºçš„å¾®åº”ç”¨æ”¯æŒæ¥å…¥-qiankun-ä¹ˆï¼Ÿ" class="header-anchor">#</a> é webpack æ„å»ºçš„å¾®åº”ç”¨æ”¯æŒæ¥å…¥ qiankun ä¹ˆï¼Ÿ</h2> <blockquote><p>æ”¯æŒ</p></blockquote> <p>éœ€è¦é¢å¤–å£°æ˜ä¸€ä¸ª <code>script</code>ï¼Œç”¨äº <code>export</code> ç›¸å¯¹åº”çš„ <code>lifecycles</code></p> <p>ä¾‹å¦‚:</p> <ol><li>å£°æ˜ entry å…¥å£</li></ol> <div class="language-diff extra-class"><pre class="language-diff"><code><span class="token deleted-arrow deleted">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
</span><span class="token unchanged">  &lt;meta charset=&quot;UTF-8&quot;&gt;
  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;
  &lt;title&gt;Purehtml Example&lt;/title&gt;
</span><span class="token deleted-arrow deleted">&lt;/head&gt;
&lt;body&gt;
</span><span class="token unchanged">  &lt;div style=&quot;display: flex; justify-content: center; align-items: center; height: 200px;&quot;&gt;
    Purehtml Example
  &lt;/div&gt;
</span><span class="token deleted-arrow deleted">&lt;/body&gt;
</span>
<span class="token inserted-sign inserted">+ &lt;script src=&quot;//yourhost/entry.js&quot; entry&gt;&lt;/script&gt;
</span><span class="token deleted-arrow deleted">&lt;/html&gt;
</span></code></pre></div><ol start="2"><li>åœ¨ entry js é‡Œå£°æ˜ lifecycles</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">$</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#purehtml-container'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, render with jQuery&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token punctuation">(</span><span class="token parameter">global</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">[</span><span class="token string">'purehtml'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">bootstrap</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'purehtml bootstrap'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">mount</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'purehtml mount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">render</span><span class="token punctuation">(</span>$<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">unmount</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'purehtml unmount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>window<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>ä½ ä¹Ÿå¯ä»¥ç›´æ¥å‚ç…§ examples ä¸­ purehtml éƒ¨åˆ†çš„<a href="https://github.com/umijs/qiankun/tree/master/examples/purehtml" target="_blank" rel="noopener noreferrer">ä»£ç <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>åŒæ—¶ï¼Œä½ ä¹Ÿéœ€è¦å¼€å¯ç›¸å…³èµ„æºçš„ CORSï¼Œå…·ä½“è¯·å‚ç…§<a href="/qiankun/zh/faq/#å­åº”ç”¨é™æ€èµ„æºä¸€å®šè¦æ”¯æŒè·¨åŸŸå—ï¼Ÿ">æ­¤å¤„</a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/umijs/qiankun/edit/master/docs/zh/faq/README.md" target="_blank" rel="noopener noreferrer">åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">5/1/2020, 6:23:58 AM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/qiankun/assets/js/app.5b918351.js" defer></script><script src="/qiankun/assets/js/2.b25794af.js" defer></script><script src="/qiankun/assets/js/13.881fc36e.js" defer></script><script src="/qiankun/assets/js/3.0164b3a4.js" defer></script>
  </body>
</html>
